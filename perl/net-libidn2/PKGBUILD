pkgname="carbonio-perl-net-libidn2"
pkgver="1.02" # renovate: datasource=cpan depName=Net::LibIDN2
pkgrel="2"
pkgdesc="Perl bindings for GNU Libidn2"
arch=('x86_64')
maintainer="Zextras <packages@zextras.com>"
url="https://zextras.com"
license=('Artistic-1.0-Perl OR GPL-1.0-or-later')
depends__apt=(
  "libidn2-0"
  "perl"
)
depends__yum=(
  "libidn2"
  "perl-core"
  "perl"
)
makedepends__apt=(
  "libidn2-0-dev"
  "libmodule-build-perl"
)
makedepends__yum=(
  "libidn2-devel"
  "perl-Module-Build"
)
section="libs"
priority="important"
source=(
  "https://search.cpan.org/CPAN/authors/id/T/TH/THOR/Net-LibIDN2-${pkgver}.tar.gz"
)
sha256sums=('d1f30afc6acfa6541b00c09a7e4c74e7d8e4ba49e3277c0bbc41ae35c1390d07')

build() {
  cd "${srcdir}/Net-LibIDN2-${pkgver}"

  perl Build.PL install_base=/opt/zextras/common \
    --extra_linker_flags="-Wl,-rpath,/opt/zextras/common/lib -L/opt/zextras/common/lib -lidn2"
  perl Build
}

package() {
  cd "${srcdir}/Net-LibIDN2-${pkgver}"

  perl Build install destdir="${pkgdir}"

  find "${pkgdir}" -name '.packlist' -delete
  find "${pkgdir}" -name '*.pod' -delete
}
