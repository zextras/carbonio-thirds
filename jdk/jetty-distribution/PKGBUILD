pkgname="carbonio-jetty-distribution"
pkgver="9.4.54.v20240208"
pkgrel="1"
pkgdesc="A pure Java-based HTTP server and Java Servlet container"
arch=('x86_64')
maintainer="Zextras <packages@zextras.com>"
url="https://github.com/zextras"
depends=(
  "carbonio-openjdk"
)
section="libs"
priority="important"
source=(
  "https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-distribution/${pkgver}/jetty-distribution-${pkgver}.tar.gz"
)
sha256sums=('e20c39354a50b16ce420343be2e517dca7c0a4de6b1f411c670a9c81002c64fc')

package() {
  cd "${srcdir}/jetty-distribution-${pkgver}"
  # executables
  mkdir -p "${pkgdir}/opt/zextras/common/jetty_home"
  find . -maxdepth 1 -mindepth 1 | grep -v -w -e debian -e rpm | xargs -r '-I{}' cp -a '{}' "${pkgdir}/opt/zextras/common/jetty_home"
  rm -rf "${pkgdir}/opt/zextras/common/jetty_home/demo-base"
  rm -rf "${pkgdir}/opt/zextras/common/jetty_home/lib/setuid/libsetuid-osx.so"
}
