pkgname="carbonio-libmilter"
pkgver="8.17.1"
pkgrel="2"
pkgdesc="Implementation of the sendmail Mail Filter API"
arch=('x86_64')
maintainer="Zextras <packages@zextras.com>"
url="https://github.com/zextras"
section="libs"
priority="important"
source=(
  "https://ftp.sendmail.org/sendmail.${pkgver}.tar.gz"
  "site.config.m4"
)
sha256sums=('04bc76b6c886e6d111be7fd8daa32b8ce00128a288b6b52e067bc29f3854a6e6'
  '9ea8ce8a8fc6179da65d0e9b7b6d7016d9a3f38070db4acce56d17a8d78ed3ad')

build() {
  cd "${srcdir}/sendmail-${pkgver}"

  cp "${srcdir}/site.config.m4" devtools/Site
  export LDFLAGS="-Wl,-rpath,/opt/zextras/common/lib"
  cd libmilter
  ./Build
}

package() {
  cd "${srcdir}/sendmail-${pkgver}"

  cd libmilter
  install -d "${pkgdir}/opt/zextras/common/lib"
  install -d "${pkgdir}/opt/zextras/common/include"
  ./Build DESTDIR="${pkgdir}" install
}
