targets=(
  "centos"
  "ubuntu"
)
pkgname="carbonio-libmilter"
pkgver="8.17.1"
pkgrel="1"
pkgdesc="Implementation of the sendmail Mail Filter API"
pkgdesclong=(
  "Implementation of the sendmail Mail Filter API"
)
arch="amd64"
maintainer="Zextras <packages@zextras.com"
url="https://zextras.com"
section="libs"
priority="important"
sources=(
  "https://ftp.sendmail.org/sendmail.${pkgver}.tar.gz"
  "site.config.m4"
)
hashsums=(
  "4cbbc2bb536a48ea27994721e9dfefff7739ef1c825bbc0397202e600d8dad8f9a2572a777204693cf9630f767865d50566f0827be6b52be41c1e25532cb394c"
  "9ea8ce8a8fc6179da65d0e9b7b6d7016d9a3f38070db4acce56d17a8d78ed3ad"
)

build() {
  cd "${srcdir}/sendmail-${pkgver}"
  cp ../site.config.m4 devtools/Site
  export LDFLAGS="-Wl,-rpath,/opt/zextras/common/lib"
  export CFLAGS="-O2"
  cd libmilter
  ./Build
}

package() {
  cd "${srcdir}/sendmail-${pkgver}"
  cd libmilter
  install -d "${pkgdir}/opt/zextras/common/lib"
  install -d "${pkgdir}/opt/zextras/common/include"
  ./Build DESTDIR="${pkgdir}" install
}
