targets=(
  "centos"
  "ubuntu"
)
pkgname="carbonio-openjdk"
pkgver="17.0.7"
pkgrel="1"
pkgdesc="OpenJDK Java 17 development kit"
pkgdesclong=(
  "OpenJDK Java 17 development kit"
)
arch="amd64"
maintainer="Zextras <packages@zextras.com"
url="https:/zextras.com"
section="utils"
priority="optional"
sources=(
  "https://github.com/adoptium/temurin17-binaries/releases/download/jdk-${pkgver}%2B7/OpenJDK17U-jdk_x64_linux_hotspot_${pkgver}_7.tar.gz"
)
provides:yum=(
  "libjli.so()(64bit)"
)
hashsums=(
  "e9458b38e97358850902c2936a1bb5f35f6cffc59da9fcd28c63eab8dbbfbc3b"
)

package() {
  cd "${srcdir}"
  mkdir -p "${pkgdir}"/opt/zextras/common/bin
  mkdir -p "${pkgdir}"/opt/zextras/common/lib/jvm
  cp -r "jdk-${pkgver}"* "${pkgdir}"/opt/zextras/common/lib/jvm/java
  cd "${pkgdir}"/opt/zextras/common/lib/jvm/java
  mv include/linux/* include
  rm -rf include/linux
  rm -rf lib/src.zip
  rm -rf legal
  chmod 644 lib/ct.sym

  cd lib/security
  rm -f cacerts
  ln -s /opt/zextras/common/etc/java/cacerts cacerts
  
  cd "${pkgdir}"/opt/zextras/common/bin
  ln -s ../lib/jvm/java/bin/jar
  ln -s ../lib/jvm/java/bin/java
  ln -s ../lib/jvm/java/bin/javac
  ln -s ../lib/jvm/java/bin/javap
  ln -s ../lib/jvm/java/bin/jhat
  ln -s ../lib/jvm/java/bin/jmap
  ln -s ../lib/jvm/java/bin/jps
  ln -s ../lib/jvm/java/bin/jstack
  ln -s ../lib/jvm/java/bin/jstat
  ln -s ../lib/jvm/java/bin/keytool
}

