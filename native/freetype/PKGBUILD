targets=(
  "centos"
  "ubuntu"
)
pkgname="carbonio-freetype"
pkgver="2.10.4"
pkgrel="1"
pkgdesc="Font rasterization library"
pkgdesclong=(
  "Font rasterization library"
)
arch="amd64"
maintainer="Zextras <packages@zextras.com"
url="https://zextras.com"
depends:apt=(
  "libbz2-1.0"
  "carbonio-base"
  "zlib1g" 
)
makedepends:apt=(
  "libbz2-dev"
  "zlib1g-dev" 
)
depends:yum=(
  "bzip2"
  "carbonio-base"
  "zlib"
)
makedepends:yum=(
  "bzip2-devel"
  "zlib-devel"
)
section="libs"
priority="important"
sources=(
  "https://download-mirror.savannah.gnu.org/releases/freetype/freetype-${pkgver}.tar.xz"
)
hashsums=(
  "86a854d8905b19698bbc8f23b860bc104246ce4854dcea8e3b0fb21284f75784"
)

build() {
  cd "${srcdir}/freetype-${pkgver}"
  export LDFLAGS="-Wl,-rpath,/opt/zextras/common/lib"
  export CFLAGS="-fPIC"
  export PKG_CONFIG_PATH="/opt/zextras/common/lib/pkgconfig"
  ./configure \
    --prefix=/opt/zextras/common \
    --disable-static
  make -j16
}

package() {
  cd "${srcdir}/freetype-${pkgver}"
  make DESTDIR="${pkgdir}" install
  rm -rf "${pkgdir}"/opt/zextras/common/lib/*.la
}
